@use '../variables' as v;
@use '../mixins' as m;
@use '../keyframes' as k;
@use '_currentTrips';

$max-height-collapsed: 21vh;
$max-height: 63dvh;

.info-window {
    @extend .current-trips;

    .table-wrapper {
        overflow: hidden;
        position: relative;
        margin-bottom: .5rem;
    }

    table {
        width: 100%;
        table-layout: fixed;
        display: block;
        max-height: $max-height;
        overflow-y: auto;
        scrollbar-width: none;
        scroll-behavior: smooth;
        transition: max-height 0.3s ease-in-out;

        &.--collapsed {
            max-height: $max-height-collapsed;
        }

        &::-webkit-scrollbar {
            display: none;
        }

        thead {
            position: sticky;
            top: 0;
            background-color: v.$primary-color;
            z-index: 10;
            display: table-header-group;
            width: 100%;
        }

        thead tr {
            border-bottom-color: v.$border-color;

            &:hover {
                background-color: v.$primary-color--muted;

            }
        }

        tbody {
            display: table-row-group;
            width: 100%;
        }

        tbody tr {
            border-bottom-color: v.$border-color;

            &:hover {
                background-color: v.$primary-color--muted;

                filter: brightness(1.1);
            }
        }

        tbody tr:first-of-type {
            background-color: v.$primary-color--muted;
        }

        caption,
        thead,
        tbody {
            width: 100%;
            display: block;
        }

        tr {
            display: table;
            width: 100%;
        }

        th:first-child,
        td:first-child {
            width: 70%;
        }

        td {
            span {
                overflow: hidden;
                display: block;
                max-width: 190px;
                text-overflow: ellipsis;

            }
        }

        th:last-child,
        td:last-child {
            width: 30%;
        }

        &.--overflowing {

            &::after {
                content: '';
                display: block;
                position: sticky;
                bottom: 0px;
                left: 0;
                right: 0;
                height: 80px;
                margin-top: -80px;
                background: linear-gradient(to bottom,
                        rgba(v.$primary-color, 0) 0%,
                        rgba(v.$primary-color, .8) 50%,
                        v.$primary-color 100%);
                pointer-events: none;

            }

            &:not(.--at-bottom)::after {
                animation: fadeGradientIn 0.25s ease-in-out both;
                will-change: opacity;
            }
        }

        &.--at-bottom::after {
            animation: fadeGradientOut 0.25s ease-in-out both;
            will-change: opacity;

        }

        @include m.desktop {
            max-height: $max-height !important;
        }

    }

    .button-wrapper {
        display: flex;
        width: 100%;
        justify-content: center;
        align-items: center;
        position: absolute;
        bottom: 0;
        left: 0;
        transition: opacity 0.25s ease-in-out;

        &.--hidden {
            opacity: 0;
        }

        @include m.desktop {
            display: none;
        }
    }

    .tbody-fade {
        animation: fadeTable 1s ease-out forwards;
        position: relative;
    }

    &__inner {
        padding: v.$padding-textBox v.$padding-textBox 0 v.$padding-textBox ;
    }

    .first-cell-pad {
        padding-left: v.$padding-textBox;
        transition: padding 1s ease .6s;
        // background-color: v.$primary-color--muted;
    }

    @for $i from 0 through 9 {
        .row-slide-#{$i} {
            $delay: $i * 0.1s;
            animation: slideUpTableRow 0.8s ease-out $delay forwards;
        }
    }

    @include m.desktop {
        top: 12vh;
        right: 10vw;
        left: unset;
        bottom: unset;
    }

    h2 {
        font-size: 1.3rem;
        line-height: 1.5;
    }

    #final-station {
        font-style: italic;
        font-weight: 300;
    }

    p {
        font-size: 1rem;
    }

}